<!DOCTYPE html>
<html>
<head>
    <title>Dashboard</title>

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body{
            background:#f4f6f9;
        }

        .sidebar{
            height:100vh;
            background:#274d58;
            color:rgb(255, 255, 255);
            padding:20px;
            position:fixed;
            width:220px;
        }

        .sidebar a{
            color:white;
            text-decoration:none;
            display:block;
            padding:10px;
            margin:10px 0;
            border-radius:6px;
        }

        .sidebar a:hover{
            background:#343a40;
        }

        .content{
            margin-left:240px;
            padding:30px;
        }

        .card{
            border:none;
            border-radius:12px;
            box-shadow:0 4px 10px rgba(0,0,0,0.1);
        }
    </style>
</head>

<body>

<!-- SIDEBAR -->
<div class="sidebar">
    <h3>General shop Dashboard</h3>
    <hr>

    <a href="/dashboard">üè† Dashboard</a>
    <a href="/products">üì¶ Products</a>
    <a href="/users">üë§ Users</a>
    <a href="/logout">üö™ Logout</a>
</div>

<!-- MAIN CONTENT -->
<div class="content">

    <h2 class="mb-4">Dashboard Overview</h2>

    <!-- STATS -->
    <div class="row mb-4">

        <div class="col-md-6">
            <div class="card p-4">
                <h5>Total Users</h5>
                <h1>{{users}}</h1>
            </div>
        </div>

        <div class="col-md-6">
            <div class="card p-4">
                <h5>Total Products</h5>
                <h1>{{products_count}}</h1>
            </div>
        </div>

    </div>
<div class="card p-4 mt-4 text-center">
    <h4>üìä System Overview</h4>

    <div style="width:400px; margin:auto;">
        <canvas id="pieChart"></canvas>
    </div>
</div>
    <!-- ADD PRODUCT -->
    <div class="card p-4 mb-4">
        <h4>Add Product</h4>

        <form action="/add" method="post" class="row g-3">
            <div class="col-md-5">
                <input class="form-control" name="name" placeholder="Product name">
            </div>

            <div class="col-md-5">
                <input class="form-control" name="quantity" placeholder="Quantity">
            </div>

            <div class="col-md-2">
                <button class="btn btn-dark w-100">Add</button>
            </div>
        </form>
    </div>

    <!-- PRODUCT TABLE -->
   <div class="card p-4">
    <h4 class="mb-3">Product List</h4>

    {% if products %}
    <table class="table table-hover align-middle">
        <thead class="table-dark">
            <tr>
                <th>ID</th>
                <th>Product Name</th>
                <th>Quantity</th>
            </tr>
        </thead>

        <tbody>
            {% for p in products %}
            <tr>
                <td>{{ p.id }}</td>
                <td>{{ p.name }}</td>
                <td>{{ p.quantity }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    {% else %}
        <p class="text-muted">No products added yet.</p>
    {% endif %}
</div>
</div>
<script>

const ctx = document.getElementById('pieChart');

new Chart(ctx, {
    type: 'pie',
    data: {
        labels: ['Users', 'Products'],
        datasets: [{
            data: [
                {{ users }},
                {{ products_count }}
            ],
            backgroundColor: [
                '#0d6efd',
                '#198754'
            ],
            borderWidth: 1
        }]
    },
    options: {
        responsive: true
    }
});

</script>
</body>
</html>